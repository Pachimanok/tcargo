<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="loading" lang="en" data-textdirection="ltr">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
	<meta name="description"
		content="Modern admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities with bitcoin dashboard.">
	<meta name="keywords"
		content="admin template, modern admin template, dashboard template, flat admin template, responsive admin template, web app, crypto dashboard, bitcoin dashboard">
	<meta name="author" content="PIXINVENT">
	<title th:text="#{text.recuperarClave.form.title.tCargo}"></title>
	<link rel="apple-touch-icon" th:href="@{/assets/img/icono.png}">
	<link rel="shortcut icon" type="image/x-icon" th:href="@{/assets/img/icono.png}">
	<link
		href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700"
		rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/fonts/material-icons/material-icons.css">

	<!-- BEGIN: Vendor CSS-->
	<link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/material-vendors.min.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/forms/icheck/icheck.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/forms/icheck/custom.css">
	<!-- END: Vendor CSS-->

	<!-- BEGIN: Theme CSS-->
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/material.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/components.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/bootstrap-extended.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/material-extended.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/material-colors.css">
	<!-- END: Theme CSS-->

	<!-- BEGIN: Page CSS-->
	<link rel="stylesheet" type="text/css"
		href="../../../app-assets/css/core/menu/menu-types/material-vertical-menu.css">
	<link rel="stylesheet" type="text/css" href="../../../app-assets/css/pages/login-register.css">
	<!-- END: Page CSS-->

	<!-- BEGIN: Custom CSS-->
	<link rel="stylesheet" type="text/css" href="../../../assets/css/style.css">
	<!-- END: Custom CSS-->

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120793348-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() {dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-120793348-1');
	</script>
</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body
	class="vertical-layout vertical-menu material-vertical-layout material-layout 1-column  bg-full-screen-image blank-page"
	data-open="click" data-menu="vertical-menu" data-col="1-column" style="opacity:0.9">
	<!-- BEGIN: Content-->
	<div class="app-content content">
		<div class="content-header row"></div>
		<div class="content-overlay"></div>
		<div class="content-wrapper">
			<div class="content-body">
				<section class="row flexbox-container">
					<div class="col-12 d-flex align-items-center justify-content-center">
						<div class="col-lg-4 col-md-8 col-10 box-shadow-2 p-0">
							<div class="card border-grey border-lighten-3 px-1 py-1 m-0">
								<div class="card-header border-0">
									<div class="card-title text-center">
										<img class="brand-logo" alt="modern admin logo" src="/img/logo-gde.png" />
										<h3 th:text="#{text.recuperarClave.form.h3.recuperarClave}"></h3>
									</div>
									<div class="alert alert-danger" th:if="${error != null}" th:text="${error}"></div>
									<div class="alert alert-danger" th:if="${errorVerificacion != null}">
										<span th:text="${errorVerificacion}"></span>
									</div>
								</div>
								<div th:if="${usuario == null}" class="card-content">

									<div class="card-body"
										th:with="url=(${errorVerificacion}?'/registro/verificacion/reenviar':'/recuperar')">

										<form class="form-horizontal" th:action="@{${url}}" method="POST" novalidate>
											<fieldset class="form-group position-relative has-icon-left">
												<label for="email" style="display: none;"
													th:text="#{text.recuperarClave.form.label.correo}">
												</label>
												<input type="email" class="form-control" id="email"
													th:placeholder="#{text.marca.list.input.ingresaMail}" name="email"
													autocomplete="off" required>
												<div class="form-control-position">
													<i class="la la-user"></i>
												</div>
											</fieldset>
											<div class="form-group row" id="err" style="display: none;">
												<div class="col-sm-12 col-12 text-center text-sm-left pr-0">
													<span style="color: red"
														th:text="#{text.recuperarClave.form.span.correoNoValido}">
													</span>
												</div>
											</div>
											<button type="submit" id="btn-submit" disabled class="btn btn-outline-info btn-block">
												<i class="ft-unlock"></i>
												<span
													th:text="${errorVerificacion != null} ? #{text.recuperarClave.form.span.reenviar} : #{text.recuperarClave.form.span.enviar} "></span>
											</button>
											<br />
										</form>

										<a th:href="@{/login}" type="button" class="btn btn-outline-info btn-block">
											<i class="la la-arrow-left"></i>
											<span th:text="#{text.recuperarClave.form.span.volverLogin}"></span>
										</a>
									</div>

								</div>

								<div th:if="${usuario != null}" class="card-content">

									<div class="card-body">
										<form class="form-horizontal" th:action="@{/cambiar}" method="POST"
											id="cambioClave" th:object="${usuario}" novalidate>
											<input type="hidden" th:field="*{id}">
											<fieldset class="form-group position-relative has-icon-left">
												<label for="clave1" style="display: none;"
													th:text="#{text.recuperarClave.form.label.claveNueva}">
												</label>
												<input type="password" class="form-control" id="clave1"
													th:placeholder="#{text.marca.list.input.ingreseClaveNueva}"
													name="clave1" autocomplete="off" th:field="*{clave1}" required>
												<label for="clave2" style="display: none;"
													th:text="#{text.recuperarClave.form.label.repetirClave}">
												</label>
												<input type="password" class="form-control" id="clave2"
													th:placeholder="#{text.marca.list.input.repitaClave}" name="clave2"
													autocomplete="off" th:field="*{clave2}" required>
												<div class="form-control-position">
													<i class="la la-key"></i>
												</div>
											</fieldset>
											<div th:if="${error != null}" class="form-group row">
												<div class="col-sm-12 col-12 text-center text-sm-left pr-0">
													<span style="color: red" th:text="${error}"></span>
												</div>
											</div>
											<div class="form-group row" id="errClave" style="display: none;">
												<div class="col-sm-12 col-12 text-center text-sm-left pr-0">
													<span style="color: red" id="errClaveText"></span>
												</div>
											</div>
											<button type="submit" class="btn btn-outline-info btn-block"
												th:text="#{text.recuperarClave.form.button.cambiarClave}">
											</button>
											<br />
										</form>
									</div>

								</div>

							</div>
						</div>
					</div>
				</section>

			</div>
		</div>
	</div>
	<!-- END: Content-->


	<!-- BEGIN: Vendor JS-->
	<script src="../../../app-assets/vendors/js/material-vendors.min.js"></script>
	<!-- BEGIN Vendor JS-->

	<!-- BEGIN: Page Vendor JS-->
	<script src="../../../app-assets/vendors/js/forms/validation/jqBootstrapValidation.js"></script>
	<script src="../../../app-assets/vendors/js/forms/icheck/icheck.min.js"></script>
	<!-- END: Page Vendor JS-->

	<!-- BEGIN: Theme JS-->
	<script src="../../../app-assets/js/core/app-menu.js"></script>
	<script src="../../../app-assets/js/core/app.js"></script>
	<!-- END: Theme JS-->

	<!-- BEGIN: Page JS-->
	<script src="../../../app-assets/js/scripts/pages/material-app.js"></script>
	<script src="../../../app-assets/js/scripts/forms/form-login-register.js"></script>
	<!-- END: Page JS-->

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

	<!--suppress RegExpRedundantEscape, PointlessBooleanExpressionJS -->
	<script th:inline="javascript">
		const act = $('form').attr('action');
		const c1 = $('#clave1');
		const errClave = $('#errClave');
		const errClaveText = $('#errClaveText');
		const err = $('#err');
		const btn = $('#btn-submit');

		$('#email').on('change keyup', () => {
			if ($('#email').val() === '') {
				err.show();
				btn.prop('disabled', true);
				//return;
			}
			if (!validEmail($('#email').val())) {
				err.show();
				btn.prop('disabled', true);
				return;
			}
			btn.prop('disabled', false);
			err.hide();
		});

		c1.on("change keyup", () => {
			if (c1.val().length <= 6) {
				errClaveText.html([[#{text.recuperarClave.form.javascript.errClaveText}]]);
				errClave.show();
				return;
			}
			errClave.hide();
		});


		function validEmail(email) {
			const emailValid = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			return emailValid.test(String(email).toLowerCase());
		}
	</script>

</body>
<!-- END: Body-->

</html>